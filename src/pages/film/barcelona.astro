---
import Layout from '../../layouts/Layout.astro';

const album = {
  title: "Barcelona, Spain",
  photos: [
    "/projects/Film/barcelona/000201620030.jpg",
    "/projects/Film/barcelona/000201620017.jpg",
    "/projects/Film/barcelona/000201620019.jpg",
    "/projects/Film/barcelona/000201620021.jpg",
    "/projects/Film/barcelona/000201620023.jpg",
    "/projects/Film/barcelona/000201620026.jpg",
    "/projects/Film/barcelona/000201620027.jpg",
    "/projects/Film/barcelona/000201620028.jpg",
  ],
};
---

<Layout title={`${album.title} | Film Photography | Emma`}>
  <style>
    @media (max-width: 768px) {
      .album-layout {
        grid-template-columns: 1fr !important;
      }
      .album-text {
        position: static !important;
        padding: 1.5rem !important;
      }
      .album-photos {
        columns: 1 !important;
        padding: 0 1.5rem 2rem 1.5rem !important;
      }
    }
  </style>
  <div style="min-height: 100vh; background-color: #162617;">
    <div class="album-layout" style="display: grid; grid-template-columns: 340px 1fr;">

      <!-- Left Column - Button and Title -->
      <div class="album-text" style="padding: 2rem 2rem 2rem; position: sticky; top: 0; height: fit-content;">
        <a href="/film-photography" style="display: inline-flex; align-items: center; gap: 0.5rem; background-color: #eeffac; color: #162617; padding: 0.6rem 1.5rem; border-radius: 50px; font-size: 0.9rem; text-decoration: none; transition: transform 0.2s, box-shadow 0.2s; margin-bottom: 2rem;" class="font-medium hover:scale-105 hover:shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
          </svg>
          Back
        </a>
        <h1 class="font-[family-name:var(--font-display)] text-3xl md:text-4xl" style="color: #eeffac;">
          {album.title}
        </h1>
      </div>

      <!-- Right Column - Photos -->
      <div class="album-photos" style="padding: 2rem 1rem 3rem 0; columns: 2; gap: 1rem;">
        {album.photos.map((photo, index) => (
          <img
            src={photo}
            alt={`${album.title} photo ${index + 1}`}
            data-index={index}
            class="gallery-photo" loading="lazy"
            style="width: 100%; margin-bottom: 1rem; break-inside: avoid; border-radius: 0.5rem; cursor: pointer;"
          />
        ))}
      </div>

    </div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 100; background-color: rgba(22, 38, 23, 0.95); backdrop-filter: blur(8px);">
    <button id="lightbox-close" style="position: absolute; top: 1.5rem; right: 1.5rem; background: none; border: none; cursor: pointer; z-index: 101;">
      <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#eeffac" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
    </button>
    <button id="lightbox-prev" style="position: absolute; left: 1.5rem; top: 50%; transform: translateY(-50%); background: rgba(238, 255, 172, 0.2); border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#eeffac" stroke-width="2"><path d="M15 18l-6-6 6-6"/></svg>
    </button>
    <button id="lightbox-next" style="position: absolute; right: 1.5rem; top: 50%; transform: translateY(-50%); background: rgba(238, 255, 172, 0.2); border: none; border-radius: 50%; width: 50px; height: 50px; cursor: pointer; display: flex; align-items: center; justify-content: center;">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#eeffac" stroke-width="2"><path d="M9 18l6-6-6-6"/></svg>
    </button>
    <div style="display: flex; align-items: center; justify-content: center; height: 100%; padding: 4rem;">
      <img id="lightbox-img" src="" alt="" style="max-width: 100%; max-height: 100%; object-fit: contain; border-radius: 0.5rem;" />
    </div>
  </div>
</Layout>

<style>
  .gallery-photo:hover { transform: scale(1.02); transition: transform 0.2s; }
  #lightbox-prev:hover, #lightbox-next:hover { background: rgba(238, 255, 172, 0.4); }
</style>

<script define:vars={{ photos: album.photos }}>
  let currentIndex = 0;
  const lightbox = document.getElementById('lightbox');
  const lightboxImg = document.getElementById('lightbox-img');

  document.querySelectorAll('.gallery-photo').forEach((img) => {
    img.addEventListener('click', () => {
      currentIndex = parseInt(img.dataset.index);
      lightboxImg.src = photos[currentIndex];
      lightbox.style.display = 'block';
      document.body.style.overflow = 'hidden';
    });
  });

  document.getElementById('lightbox-close').addEventListener('click', () => {
    lightbox.style.display = 'none';
    document.body.style.overflow = '';
  });

  lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) {
      lightbox.style.display = 'none';
      document.body.style.overflow = '';
    }
  });

  document.getElementById('lightbox-prev').addEventListener('click', (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex - 1 + photos.length) % photos.length;
    lightboxImg.src = photos[currentIndex];
  });

  document.getElementById('lightbox-next').addEventListener('click', (e) => {
    e.stopPropagation();
    currentIndex = (currentIndex + 1) % photos.length;
    lightboxImg.src = photos[currentIndex];
  });

  document.addEventListener('keydown', (e) => {
    if (lightbox.style.display === 'block') {
      if (e.key === 'Escape') { lightbox.style.display = 'none'; document.body.style.overflow = ''; }
      else if (e.key === 'ArrowLeft') { currentIndex = (currentIndex - 1 + photos.length) % photos.length; lightboxImg.src = photos[currentIndex]; }
      else if (e.key === 'ArrowRight') { currentIndex = (currentIndex + 1) % photos.length; lightboxImg.src = photos[currentIndex]; }
    }
  });
</script>
